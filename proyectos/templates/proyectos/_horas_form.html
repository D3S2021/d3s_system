<form id="formHoras" method="post" action="{% url 'proyectos:horas_nueva' %}">
  {% csrf_token %}

  <div class="mb-3">
    <label for="id_fecha" class="form-label">Fecha</label>
    <div class="input-group">
      {{ form.fecha }}
      <button type="button" class="btn btn-outline-secondary" id="btnHoy">Hoy</button>
    </div>
  </div>

  <!-- Proyecto / Área -->
  <div class="mb-3">
    <label for="id_proyecto" class="form-label">Proyecto / Área</label>
    {{ form.proyecto }}
  </div>

  <div class="row g-3">
    <div class="col-md-6">
      <label for="id_inicio" class="form-label">Inicio</label>
      {{ form.inicio }}
    </div>
    <div class="col-md-6">
      <label for="id_fin" class="form-label">Fin</label>
      {{ form.fin }}
    </div>
  </div>

  {% if not form.usuario.is_hidden %}
  <div class="mb-3" style="margin-top:12px">
    <label for="id_usuario" class="form-label">Usuario</label>
    {{ form.usuario }}
  </div>
  {% endif %}

  <div class="mb-3" style="margin-top:12px">
    <label for="id_descripcion" class="form-label">Descripción</label>
    {{ form.descripcion }}
  </div>

  <div class="d-flex justify-content-end">
    <button type="submit" class="btn btn-primary me-2">Guardar</button>
    <button type="button" class="btn btn-secondary" id="btnCancelarHoras" data-bs-dismiss="modal">Cancelar</button>
  </div>
</form>

<script>
(function(){
  const btnHoy = document.getElementById("btnHoy");
  if (btnHoy) btnHoy.addEventListener("click", function(){
    const hoy = new Date().toISOString().split("T")[0];
    const fecha = document.getElementById("id_fecha");
    if (fecha) fecha.value = hoy;
  });
})();
</script>
